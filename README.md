# WebJARVIS - AI Browser Agent

Автономный AI-агент для автоматизации браузера на базе OpenAI GPT-4o и Playwright.

## Возможности

- Автономное управление браузером для выполнения сложных многошаговых задач
- Видимый браузер (не headless) для наблюдения за работой агента
- Поддержка persistent sessions (пользователь может войти вручную, агент продолжает работу)
- Умное управление контекстом с ограничением токенов
- Sub-agent architecture для специализированных задач (DOM Sub-agent, Form Agent, Reading Agent, Decision Agent)
- Адаптивная обработка ошибок с AI-анализом
- Security layer для проверки деструктивных действий
- **query_dom** - получение информации о структуре страницы через DOM Sub-agent
- **Mouse API fallback** - автоматический fallback на реальные события мыши для надежных кликов
- Улучшенная обработка контейнеров и кликабельных элементов

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
playwright install chromium
```

2. Создайте файл `.env` в корне проекта на основе `.env.example`:
```bash
cp .env.example .env
```

Затем отредактируйте `.env` и укажите ваш API ключ:
```
OPENAI_API_KEY=your_api_key_here
```

3. Запустите агента:
```bash
python main.py
```

Или с параметрами:
```bash
python main.py --session my_session --task "Ваша задача здесь"
```

## Использование

После запуска введите задачу текстом, и агент начнет её выполнение в браузере.

### Примеры задач:
- "Найди вакансии Python разработчика на hh.ru и сохрани первые 5"
- "Прочитай последние 10 писем в яндекс почте и удали спам"
- "Зарегистрируйся на сайте example.com"
- "Найди информацию о погоде в Москве"

### Основные возможности:

**query_dom** - агент может задавать вопросы DOM Sub-agent'у о структуре страницы:
- "Какие элементы представляют собой письма на странице? Укажите их селекторы и визуальное состояние"
- "Есть ли на странице элементы для выбора адреса доставки? Что там отображается?"

**Mouse API fallback** - автоматически используется когда обычные клики не работают:
- Агент автоматически переключается на реальные события мыши при необходимости
- Особенно полезно для сайтов с JavaScript обработчиками событий

## Переменные окружения

См. `.env.example` для полного списка доступных переменных окружения. Основные:

- `OPENAI_API_KEY` (обязательно) - API ключ OpenAI
- `OPENAI_MODEL` (опционально) - модель OpenAI, по умолчанию `gpt-4o`
- `BROWSER_TYPE` (опционально) - тип браузера: `chromium`, `firefox`, `webkit`
- `HEADLESS` (опционально) - запуск в headless режиме: `true` или `false`
- `MAX_ITERATIONS` (опционально) - максимальное количество итераций, по умолчанию `50`

